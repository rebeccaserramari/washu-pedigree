# Helper Scripts for Centromere Mutation Validation

This folder contains helper scripts for processing pairwise sequence alignments generated by the [EMBOSS **STRETCHER** aligner](https://www.ebi.ac.uk/jdispatcher/psa/emboss_stretcher).

---

## Scripts
Each script contains detailed documentation and usage instructions within the script files themselves.

### 1. `stretcher_parser.py`
Parse pairwise alignments generated by the Stretcher tool and extract mismatch and gap information into TSV file.

- **Features**:
  - **Records positions** with mismatches and gaps from alignment.
  - **Ignores leading and trailing positions** until a valid base pair (A/C/G/T) is encountered.
  - Supports **offsets** for both sequences (`offset_seq1` and `offset_seq2`), allowing the user to specify starting positions so that the output positions match the original genomic coordinates.

- **Arguments**:
  - `<input_alignment_file>` – Stretcher alignment output file (.aln)
  - `<output_file.tsv>` – path to TSV file to write mismatch/gap records
  - `<sequence_name>` – name used as label in the output
  - `<offset_seq1>` – integer offset added to reference positions
  - `<offset_seq2>` – integer offset added to alternate positions


```bash
# Usage
python stretcher_parser.py <input_alignment_file> <output_file.tsv> <sequence_name> <offset_seq1> <offset_seq2>

# Example
python stretcher_parser.py alignment.aln centromere_mutations.tsv chr1 0 0
```

- **Output**:
  - A TSV file containing positions and nucleotides of mismatches and gaps extracted from the input alignment.
    - Sequence name (from input data)
    - Reference position
    - Reference base or gap
    - Alternate base or gap
    - Alternate position
  - Prints alignment statistics (total positions, mismatches, gaps, and percentages) to the command line.

### 2. `collapse_consecutive_positions.py`
Reformat TSV output from `stretcher_parser.py` by collapsing consecutive positions into single lines for easier analysis.

- **Arguments**:
    - `<input_file.tsv>` – TSV file output (format as output from **stretcher_parser.py**)
    - `<output_file.tsv>` – collapsed output in TSV format

```bash
# Usage
python collapse_consecutive_positions.py <input_file.tsv> <output_file.tsv>

# Example
python collapse_consecutive_positions.py centromere_mutations.tsv centromere_mutations_collapsed.tsv
```

- **Output**:
  - A TSV file where consecutive positions are merged into single lines, maintaining the reference and alternate sequences. The output file contains following columns:
    - Sequence name
    - Reference position
    - Reference nucleotide(s) or gap ('-')
    - Alternate position
    - Alternate nucleotide(s) or gap ('-')